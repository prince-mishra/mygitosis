#!/usr/bin/make -f
# -*- mode: makefile; coding: utf-8 -*-

ifeq ($(wildcard debian/control),)
ifeq ($(DEB_AUTO_UPDATE_DEBIAN_CONTROL),)
advice_about_control := yes
endif
endif

ifeq ($(advice_about_control),yes)
advice-on-debian-control %::
	@echo "It seems you are building from pristine source and"
	@echo "debian/control is missing. It will be autogenerated"
	@echo "if you say:"
	@echo
	@echo "  ./debian/rules generate"
	@echo
	@exit 1
else

DEB_PYTHON_SYSTEM := pysupport

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/python-distutils.mk

clean::
	rm -rf dist gitosis.egg-info
endif


generate::
#	I wish this was atomic
	cp debian/control.in debian/control
	fakeroot env DEB_AUTO_UPDATE_DEBIAN_CONTROL=1 ./debian/rules clean
